
<% if @role=="doctor" %>
  <div class="queue-section">
    <div class="container">
      <h3 class="center-align dashboard-title"> Queue system </h3>
      <p>There are currently <%= @queue_size %> patients in queue.</p>

      <p>Click to begin consultation with <a href="/patient/<%= @first_in_line.user_id %>/consults/new">next patient</a></p></p>
    </div>
  </div>

  <div class="patient-dashboard-section">
    <div class="container">
      <h3 class="center-align dashboard-title">Patient List</h3>
      <div class="row">
        <div class="col s12">
          <h5>Search Patient</h5>
          <div class="input-field">
            <input class="white autocomplete" placeholder="Name or ID Number" type="text" id="search-input">
          </div>
        </div>
      </div>
      <ul class="collection">
        <% @patients.each do |patient| %>

          <li class="collection-item avatar flexbox">
            <i class="material-icons circle">perm_identity</i>
            <div class="patient-data">
              <%= link_to patient.first_name + " " + patient.last_name + " " +  patient.id_number.to_s, patient_path(patient.id), class: "patient-row"%>
            </div>
            <%= link_to 'Consult', new_patient_consult_path(patient.id), class: "waves-effect waves-light btn-small" %>
          </li>
          
        <% end %>
      </ul>
    </div>
  </div>

<% elsif %>
<div class="container">
  <h2>Queue system</h2>

  <p>There are currently <%= @queue_size %> patients in queue.</p>

  <div>
  <%= form_with scope: :request, url: '/requests', local: true do |form| %>
    <%= form.text_field :user_id, :hidden => true, value: current_user.id %>
    <%= form.submit('Request Consultation') %>
  <% end %></div>

  <div>
  <%= form_with scope: :request, url: '/requests/cancel', local: true do |form| %>
    <%= form.text_field :user_id, :hidden => true, value: current_user.id %>
    <%= form.submit('Cancel Request') %>
  <% end %></div>


  <h2 class="center-align">Consultation History</h2>
    <ul class="collection">
      <% @output.each do |consult| %>
        <li class="collection-item avatar">
        <i class="material-icons circle">description</i>
        <span>Visit ID: <%= consult.id %></span>
        <p><%= link_to consult.created_at, consult_path(consult), class: "datetime"%></p>
        </li>
      <% end %>
    </ul>
    <br>
<% end %>

  <%= link_to 'Back', root_path %>
</div>
