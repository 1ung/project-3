<% if @role=="doctor" %>
  <div class="queue-section">
    <div class="container">
      <h3 class="center-align dashboard-title"> Patient Queue </h3>

      <% if @queue.size == 0 %>

        <p>There are currently no patients in queue. Refresh the page to update.</p>

      <% else %>

        <p>There are currently <%= @queue.size %> patients in queue.</p>
        <ul class="collection">
          <% @queue.each do |request| %>
            <li class="collection-item avatar flexbox queue">
              <i class="material-icons circle">perm_identity</i>
              <div class="patient-data">
                <%= link_to request.user.first_name + " " + request.user.last_name + " " +  request.user.id_number.to_s, patient_path(request.user_id), class: "patient-row"%>
              </div>
              <div class="button-group">
                <%= form_with scope: :request, url: requests_cancel_path, local: true, class: "drop-form" do |form| %>
                <%= form.text_field :user_id, :hidden => true, value: request.user_id %>
                <a class="red waves-effect waves-light btn-small"><%= form.submit('Drop Queue') %></a>
                <% end %>

                <%= link_to 'Consult', new_patient_consult_path(request.user_id), class: "waves-effect waves-light btn-small" %>
              </div>
            </li>
          <% end %>
        </ul>
      <% end %>
    </div>
  </div>

  <div class="patient-dashboard-section">
    <div class="container">
      <h3 class="center-align dashboard-title">Patient List</h3>
      <div class="row">
        <div class="col s12">
          <h5>Search Patient</h5>
          <div class="input-field">
            <input class="white autocomplete" placeholder="Name or ID Number" type="text" id="search-input">
          </div>
        </div>
      </div>
      <ul class="collection">
        <% @patients.each do |patient| %>

          <li class="collection-item avatar flexbox pat-data">
            <i class="material-icons circle">perm_identity</i>
            <div class="patient-data">
              <%= link_to patient.first_name + " " + patient.last_name + " " +  patient.id_number.to_s, patient_path(patient.id), class: "patient-row"%>
            </div>
            <div class="button-group">
              <%= link_to 'Consult', new_patient_consult_path(patient.id), class: "waves-effect waves-light btn-small" %>
            </div>
          </li>

        <% end %>
      </ul>
    </div>
  </div>

<% else %>
<div class="container">
  <h2>Queue system</h2>

  <p>There are currently <%= @queue_size %> patients in queue.</p>
  <div>
  <%= form_with scope: :request, url: '/requests', local: true do |form| %>
    <%= form.text_field :user_id, :hidden => true, value: current_user.id %>
    <a class="waves-effect waves-light btn-small"><%= form.submit('Request Consultation') %></a>
  <% end %></div>
<br>
  <div>
    <%= form_with scope: :request, url: '/requests/cancel', local: true do |form| %>
      <%= form.text_field :user_id, :hidden => true, value: current_user.id %>
      <a class="waves-effect waves-light btn-small"><%= form.submit('Cancel Request') %></a>
    <% end %>
  </div>


  <h2 class="center-align">Consultation History</h2>
    <ul class="collection">
      <% @output.each do |consult| %>
        <li class="collection-item avatar">
        <i class="material-icons circle">description</i>
        <span>Visit ID: <%= consult.id %></span>
        <p><%= link_to consult.created_at, consult_path(consult), class: "datetime"%></p>
        </li>
      <% end %>
    </ul>
    <br>
<% end %>
</div>
